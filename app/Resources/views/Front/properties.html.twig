{% extends 'Front/layout.html.twig' %}

{% block title %}{{ 'menu.properties' | trans }} · {{ parent() }}{% endblock %}
{% block metadescription %}{% endblock %}
{% block metakeywords %}{% endblock %}

{% block bodyattr %}data-ng-app="propertiesApp"{% endblock %}

{% block javascriptshead %}
    {{ parent() }}
    <script src="/js/my.js"></script>
{% endblock %}

{% block main %}
    <div class="container" data-ng-controller="MainCtrl" data-ng-init="init('{{ propertiesFormFilter }}', {{ selectedPropertiesFormFilter }}, {{ filteredProperties }})">
        <div class="row no-m-bottom">
            <div class="col-md-12">
                <h1 class="c-orange no-m-botton properties-list-h1"><span class="search-icon"></span>{{ 'properties.heading.title' | trans | upper }}</h1>
            </div>
        </div>
        <div class="row extra-m-bottom-30">
            <div class="col-md-4">
                <div class="left-search-panel">
                    <form name="filterForm" action="" role="form">
                        {#<div class="form-group">
                            {#<label for="propertyCategory" class="control-label">{{ 'properties.form.category' | trans | upper }}</label>
                            {#<select multiple id="propertyCategory" class="form-control" data-ng-model="categories" required="required" data-ng-options="cat.name for cat in form.categories" data-ng-change="formListener()"></select>#}
                            {#<div class="btn-group btn-group-sm" role="group" data-aria-label="propertyCategory">
                                <label class="btn btn-default" data-ng-repeat="cat in form.categories" data-ng-model="categories" data-btn-radio="'cat.id'" data-ng-change="formListener()">[[ cat.name ]]</label>
                            {#</div>#
                            <label class="checkbox-inline" data-ng-repeat="cat in form.categories">
                                <input type="checkbox" name="selectedCategories[]" value="[[ cat.id ]]"  data-ng-click="toggleSelection(cat)"> [[ cat.name ]]
                            </label>
                        </div>#}
                        <div class="form-group">
                            {#<div class="btn-group btn-group-sm" role="button" data-toggle="buttons">#}
                                <label {#class="btn btn-default"#} data-ng-repeat="cat in form.categories">
                                    <input type="checkbox" checklist-model="categories" checklist-value="cat.id" data-ng-click="formListener()"> [[ cat.name ]]
                                </label>
                            {#</div>#}
                        </div>
                        <div class="form-group">
                            <label for="propertyType" class="control-label">{{ 'properties.form.type' | trans | upper }}</label>
                            <select id="propertyType" class="form-control" data-ng-model="type" required="required" data-ng-options="t.name for t in form.types" data-ng-change="formListener()">
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="propertyCity" class="control-label">{{ 'properties.form.city' | trans | upper }}</label>
                            <select id="propertyCity" class="form-control" data-ng-model="city" required="required" data-ng-options="c.name for c in form.cities" data-ng-change="formListener()">
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="propertyArea" class="control-label">[[ area ]] M<sup>2</sup> {{ 'properties.form.area' | trans | upper }}</label>
                            <input id="propertyArea" type="range" name="propertyArea" min="40" max="300" data-ng-model="area" value="[[ area ]]" step="10">
                        </div>
                        <div class="form-group">
                            <label for="propertyRooms" class="control-label">[[ rooms ]] {{ 'properties.form.rooms' | trans | upper }}</label>
                            <input id="propertyRooms" type="range" name="propertyRooms" min="2" max="6" data-ng-model="rooms" value="[[ rooms ]]">
                        </div>
                        <div class="form-group">
                            <label for="propertyPrice" class="control-label">[[ getCurrency(price) ]] &euro; {# 'properties.form.price' | trans | raw #}</label>
                            <input id="propertyPrice" type="range" name="propertyPrice" min="10000" max="300000" data-ng-model="price" value="[[ price ]]" step="10000">
                        </div>
                        <div class="form-group">
                            <p data-ng-show="properties.length > 0" class="form-control-static c-orange">[[ properties.length ]] {{ 'properties.form.results' | trans | lower }}</p>
                        </div>
                    </form>
                </div>
            </div>
            <div class="col-md-8">
                <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options" control="map.control" bounds="map.bounds">
                    <ui-gmap-markers data-ng-if="properties" models="properties" idKey="id" coords="'coords'" fit="true" doCluster="true" clusterOptions="map.clusterOptions"></ui-gmap-markers>
                </ui-gmap-google-map>
            </div>
        </div>
        <hr class="hr-homepage">
        <div data-ng-repeat="property in properties">
            <div class="row">
                <div class="col-md-4">
                    <a data-ng-if="property.first_image_path" href="[[ getUrlPropertyDetail(property) ]]">
                        <img class="img-responsive" data-ng-src="[[ property.first_image_path ]]" alt="[[ property.name ]]">
                    </a>
                </div>
                <div class="col-md-8">
                    <div class="wrapper" data-ng-class="{ 'bg-dark-orange': property.offer_special || property.offer_discount }">
                        <div class="row ">
                            <div class="col-md-6">
                                <h2 class="no-m no-bold-font font-size-13"><a href="[[ getUrlPropertyDetail(property) ]]">Ref. [[ property.reference ]]</a></h2>
                                <h2 class="no-m"><a href="[[ getUrlPropertyDetail(property) ]]">[[ property.name | uppercase ]]</a></h2>
                                <h3 class="no-m-top extra-m-bottom-27" data-ng-if="property.show_price_only_with_numbers">[[ getCurrency(property.price) ]] € <small data-ng-if="property.old_price">{{ 'homepage.property.before' | trans }} [[ getCurrency(property.old_price) ]] €</small></h3>
                                <h3 class="no-m-top extra-m-bottom" data-ng-if="!property.show_price_only_with_numbers">{{ 'homepage.property.since' | trans }} [[ getCurrency(property.price) ]] €</h3>
                            </div>
                            <div class="col-md-6">
                                <p>[[ property.description | words:10:ignoreSpaces ]]</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="no-m-bottom ribbons list-unstyled list-inline">
                                    <li data-ng-if="property.offer_special" class="special-offer">{{ 'homepage.property.offer.special' | trans }}</li>
                                    <li data-ng-if="property.offer_discount && !property.offer_special" class="discount-offer">{{ 'homepage.property.offer.discount' | trans }}</li>
                                    <li data-ng-if="property.square_meters" class="square-meters">[[ property.square_meters ]] m<sup>2</sup></li>
                                    <li data-ng-if="property.rooms" class="square-rooms">[[ property.rooms ]] {{ 'homepage.property.rooms' | trans }}</li>
                                    <li data-ng-if="property.bathrooms" class="square-bathrooms">[[ property.bathrooms ]] {{ 'homepage.property.bathrooms' | trans }}</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <p class="extra-m-top-35 no-m-bottom"><a class="c-orange" href="[[ getUrlPropertyDetail(property) ]]">{{ 'properties.list.button.more' | trans }}</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="hr-properties" data-ng-class="{'last': $last}">
        </div>
        <div class="row" data-ng-hide="properties.length">
            <div class="col-md-12">
                <div class="well">
                    <p class="lead">{{ 'properties.list.empty' | trans }}</p>
                </div>
            </div>
        </div>
    </div>
    {# Scroll-Top effect #}
    <div class="scroll-top-wrapper"><span class="scroll-top-inner"><i class="fa fa-2x fa-arrow-circle-up"></i></span></div>
{% endblock %}

{% block javascriptsbody %}
    {% include ':Front/commons:scroll-to-top-js.html.twig' %}
{% endblock %}

{% block footlangca %}{{ path('front_properties', {'_locale': 'ca'}) }}{% endblock %}
{% block footlanges %}{{ path('front_properties', {'_locale': 'es'}) }}{% endblock %}
{% block footlangen %}{{ path('front_properties', {'_locale': 'en'}) }}{% endblock %}
{% block footlangfr %}{{ path('front_properties', {'_locale': 'fr'}) }}{% endblock %}
